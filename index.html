<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Domine a IA</title>
<style>
    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #000;
        scroll-behavior: smooth;
    }

    main {
        scroll-snap-type: y mandatory;
        overflow-y: scroll;
        height: 100vh;
    }

    section {
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        scroll-snap-align: start;
        position: relative; /* necessário para overlay */
    }

    img {
        max-width: 100vw;
        max-height: 100vh;
        object-fit: contain; /* mantém proporção sem cortar */
        display: block;
    }

    .link-overlay {
        position: absolute;
        background: transparent;
        /* para debug: outline: 2px dashed lime; */
        /* garante clique mesmo transparente */
        pointer-events: auto;
    }
</style>
</head>
<body>

<main>
    <!-- Foto 11 -->
    <section id="foto11">
        <img id="img11" src="foto11.jpeg" alt="Foto 11">
        <a id="link11" class="link-overlay"
           href="https://pay.kiwify.com.br/HD1yf7E"
           target="_blank" aria-label="Pagamento"></a>
    </section>

    <section id="foto12"><img src="foto12.jpeg" alt="Foto 12"></section>
    <section id="foto13"><img src="foto13.jpeg" alt="Foto 13"></section>
    <section id="foto14"><img src="foto14.jpeg" alt="Foto 14"></section>
    <section id="foto15"><img src="foto15.jpeg" alt="Foto 15"></section>
    <section id="foto16"><img src="foto16.jpeg" alt="Foto 16"></section>
    <section id="foto17"><img src="foto17.jpeg" alt="Foto 17"></section>
    <section id="foto18"><img src="foto18.jpeg" alt="Foto 18"></section>
    <section id="foto19"><img src="foto19.jpeg" alt="Foto 19"></section>

    <!-- Foto 20 -->
    <section id="foto20">
        <img id="img20" src="foto20.jpeg" alt="Foto 20">
        <a id="link20" class="link-overlay"
           href="https://pay.kiwify.com.br/HD1yf7E"
           target="_blank" aria-label="Pagamento"></a>
    </section>
</main>

<script>
(function() {
  const naturalW = 1920, naturalH = 1080;

  // Debounce simples para resize/orientation
  let rafId = null;
  function schedule(fn) {
    if (rafId) cancelAnimationFrame(rafId);
    rafId = requestAnimationFrame(fn);
  }

  function positionLink(imgId, linkId, sectionId, coords) {
    const [x1, y1, x2, y2] = coords;
    const img = document.getElementById(imgId);
    const link = document.getElementById(linkId);
    const section = document.getElementById(sectionId);
    if (!img || !link || !section) return;

    function update() {
      // garante que rect reflita imagem carregada
      if (!img.naturalWidth || !img.complete) return;

      const imgRect = img.getBoundingClientRect();
      const secRect = section.getBoundingClientRect();

      // tamanho exibido da imagem
      const displayedW = imgRect.width;
      const displayedH = imgRect.height;

      // escala relativa à imagem original
      const scaleX = displayedW / naturalW;
      const scaleY = displayedH / naturalH;

      // deslocamento da imagem dentro da seção (contém centralização e faixas pretas)
      const offsetLeft = imgRect.left - secRect.left;
      const offsetTop  = imgRect.top  - secRect.top;

      // posicionamento final
      const left = offsetLeft + x1 * scaleX;
      const top  = offsetTop  + y1 * scaleY;
      const width  = (x2 - x1) * scaleX;
      const height = (y2 - y1) * scaleY;

      link.style.left = left + 'px';
      link.style.top = top + 'px';
      link.style.width = width + 'px';
      link.style.height = height + 'px';
    }

    // atualiza quando a imagem carrega
    img.addEventListener('load', () => schedule(update));

    // atualiza em resize e mudança de orientação
    window.addEventListener('resize', () => schedule(update));
    window.addEventListener('orientationchange', () => schedule(update));

    // atualiza ao entrar na tela (útil com scroll-snap)
    const obs = new IntersectionObserver((entries) => {
      if (entries.some(e => e.isIntersecting)) schedule(update);
    }, { root: document.querySelector('main'), threshold: 0.1 });
    obs.observe(section);

    // se já carregou, tenta posicionar
    if (img.complete) schedule(update);
  }

  // Foto 11 → coords (100,734)-(464,820)
  positionLink('img11', 'link11', 'foto11', [100,734,464,820]);

  // Foto 20 → coords (100,896)-(437,981)
  positionLink('img20', 'link20', 'foto20', [100,896,437,981]);
})();
</script>

</body>
</html>
